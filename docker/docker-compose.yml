version: '3.8'

services:
  neko-main:
    image: ghcr.io/project-n-e-k-o/n.e.k.o:amd64-v0.5.3
    container_name: neko
    restart: unless-stopped
    ports:
      #webui端口（默认48911）
      - "${NEKO_MAIN_SERVER_PORT:-48911}:48911"
    environment:
      # API Keys
      - NEKO_CORE_API_KEY=${NEKO_CORE_API_KEY}
      - NEKO_ASSIST_API_KEY_QWEN=${NEKO_ASSIST_API_KEY_QWEN:-}
      - NEKO_ASSIST_API_KEY_OPENAI=${NEKO_ASSIST_API_KEY_OPENAI:-}
      - NEKO_ASSIST_API_KEY_GLM=${NEKO_ASSIST_API_KEY_GLM:-}
      - NEKO_ASSIST_API_KEY_STEP=${NEKO_ASSIST_API_KEY_STEP:-}
      - NEKO_ASSIST_API_KEY_SILICON=${NEKO_ASSIST_API_KEY_SILICON:-}
      - NEKO_MCP_TOKEN=${NEKO_MCP_TOKEN:-}
      
      # API Providers
      - NEKO_CORE_API=${NEKO_CORE_API:-qwen}
      - NEKO_ASSIST_API=${NEKO_ASSIST_API:-qwen}
      
      # Server Ports
      - NEKO_MAIN_SERVER_PORT=48911
      - NEKO_MEMORY_SERVER_PORT=48912
      - NEKO_MONITOR_SERVER_PORT=48913
      - NEKO_TOOL_SERVER_PORT=48915
      
      # Models (Optional)
      - NEKO_SUMMARY_MODEL=${NEKO_SUMMARY_MODEL:-qwen-plus}
      - NEKO_CORRECTION_MODEL=${NEKO_CORRECTION_MODEL:-qwen-max}
      - NEKO_EMOTION_MODEL=${NEKO_EMOTION_MODEL:-qwen-turbo}
      - NEKO_VISION_MODEL=${NEKO_VISION_MODEL:-qwen3-vl-plus-2025-09-23}
      
      # MCP
      - NEKO_MCP_ROUTER_URL=${NEKO_MCP_ROUTER_URL:-http://localhost:3283}
    
    volumes:
      # 持久化配置
      - ./N.E.K.O:/root/Documents/N.E.K.O
      # 日志
      - ./logs:/app/logs
    
    networks:
      - neko-network

networks:
  neko-network:
    driver: bridge
